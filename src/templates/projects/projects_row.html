<!-- 
    左側列表單項
    Layout: 左側狀態(小) | 右側名稱(大)
-->
<div class="card border-0 shadow-sm project-sidebar-item cursor-pointer" id="project-{{ project.id }}">
    <div class="card-body p-3">
        <!-- 上方：改為 Flex Row，左側狀態、右側名稱 -->
        <div class="d-flex align-items-center">
            <!-- 左欄(小)：狀態 -->
            <div class="flex-shrink-0 me-3">
                <span class="badge rounded-pill 
                    {% if project.status == 'active' %}bg-success bg-opacity-10 text-success
                    {% elif project.status == 'closed' %}bg-secondary bg-opacity-10 text-secondary
                    {% else %}bg-warning bg-opacity-10 text-warning{% endif %}">
                    {{ project.status }}
                </span>
            </div>

            <!-- 右欄(大)：名稱 -->
            <div class="flex-grow-1" style="min-width: 0;">
                <!-- 
                    [關鍵修改] hx-push-url
                    改成 "?project_id={{ project.id }}"
                    這樣網址會變成 /ui/projects/?project_id=...
                    重新整理時，後端會載入列表頁，然後透過 JS 自動打開詳情
                -->
                <a href="#" 
                   class="text-decoration-none text-dark fw-bold stretched-link text-truncate d-block"
                   hx-get="/ui/projects/{{ project.id }}"
                   hx-target="#main-workspace"
                   hx-swap="innerHTML"
                   hx-push-url="?project_id={{ project.id }}">
                   {{ project.name }}
                </a>
            </div>
        </div>
        
        <!-- 下方：日期與操作 -->
        <div class="d-flex justify-content-between align-items-end mt-2">
            <small class="text-muted" style="font-size: 0.8rem;">
                <i class="far fa-calendar me-1"></i>{{ project.start_date.strftime('%Y-%m-%d') if project.start_date else 'N/A' }}
            </small>
            
            <!-- 刪除按鈕 (需提高 z-index 以免觸發 stretched-link) -->
            <button class="btn btn-sm btn-link text-danger p-0 position-relative z-2"
                    hx-delete="/ui/projects/{{ project.id }}"
                    hx-confirm="確定要刪除此專案嗎？"
                    hx-target="#project-{{ project.id }}"
                    hx-swap="outerHTML"
                    title="刪除專案">
                <i class="fas fa-trash-alt"></i>
            </button>
        </div>
    </div>
</div>

<style>
    .project-sidebar-item { border-left: 4px solid transparent; transition: all 0.2s; }
    .project-sidebar-item:hover { background-color: #f8f9fa; border-left-color: var(--bs-primary); }
</style>
<!-- 
    報價單編輯表單 (水平佈局)
    用於右側面板的寬版顯示
-->
<form hx-encoding="multipart/form-data" class="card shadow border-2 border-primary mb-3">
    <!-- 隱藏欄位：Project ID -->
    <input type="hidden" name="project_id" value="{{ request.query_params.get('project_id', '') or quote.project_id }}">

    <div class="card-header bg-primary bg-opacity-10 py-2 d-flex justify-content-between align-items-center">
        <span class="fw-bold text-primary"><i class="fas fa-edit me-1"></i>{{ '編輯報價單' if quote.id else '新增報價單' }}</span>
        <div class="d-flex gap-2">
            <button type="button" class="btn btn-sm btn-primary"
                    {% if quote.id %} hx-put="/ui/quotes/{{ quote.id }}" {% else %} hx-post="/ui/quotes" {% endif %}
                    hx-include="closest form" hx-target="closest form" hx-swap="outerHTML">
                <i class="fas fa-save"></i> 儲存
            </button>
            <button type="button" class="btn btn-sm btn-secondary"
                    {% if quote.id %} hx-get="/ui/quotes/{{ quote.id }}?cancelled=true" hx-target="closest form" hx-swap="outerHTML"
                    {% else %} onclick="this.closest('form').remove()" {% endif %}>
                取消
            </button>
        </div>
    </div>

    <div class="card-body">
        <div class="row g-3">
            <div class="col-md-3">
                <label class="form-label small text-muted fw-bold">單號</label>
                <input type="text" name="quote_number" class="form-control" value="{{ quote.quote_number or '' }}" required placeholder="Q-2024...">
            </div>
            <div class="col-md-3">
                <label class="form-label small text-muted fw-bold">狀態</label>
                <select name="status" class="form-select">
                    <option value="draft" {% if quote.status=='draft' %}selected{% endif %}>Draft</option>
                    <option value="sent" {% if quote.status=='sent' %}selected{% endif %}>Sent</option>
                    <option value="accepted" {% if quote.status=='accepted' %}selected{% endif %}>Accepted</option>
                </select>
            </div>
            <div class="col-md-3">
                <label class="form-label small text-muted fw-bold">有效期</label>
                <input type="date" name="valid_until" class="form-control" value="{{ quote.valid_until.strftime('%Y-%m-%d') if quote.valid_until else '' }}">
            </div>
            <div class="col-md-3">
                <label class="form-label small text-muted fw-bold">總金額</label>
                <input type="number" step="0.01" name="total_amount" class="form-control text-end" value="{{ quote.total_amount or 0 }}">
            </div>
        </div>
    </div>
</form>